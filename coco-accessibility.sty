%%
%% This is file `coco-accessibility.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% cocotex.dtx  (with options: `a11y-sty')
%% 
%% IMPORTANT NOTICE:
%% 
%% For the copyright see the source file.
%% 
%% Any modified versions of this file must be renamed
%% with new filenames distinct from coco-accessibility.sty.
%% 
%% For distribution of the original source see the terms
%% for copying and modification in the file cocotex.dtx.
%% 
%% This generated file may be distributed as long as the
%% original source files, as listed above, are part of the
%% same distribution. (The sources need not necessarily be
%% in the same archive or directory.)
%%
%% Accessibility features for \textit{xerif} projects.
%%
%% Maintainer: p.schulz@le-tex.de
%%
%% lualatex  -  texlive > 2018
%%
\NeedsTeXFormat{LaTeX2e}[2018/12/01]
\ProvidesPackage{coco-common}
    [2024/01/17 0.4.0 CoCoTeX common module]
\def\tp@if@ally{\expandafter\@firstoftwo}
\RequirePackage[pdftex,pdflang=De,noautotag]{ltpdfa}%,nodetree,dospaces,doparas,,debug
\RequirePackage{coco-title}%
\tpAddToType{Components}{titlepage}{\tp@ally@comps}
\def\tp@ally@comps{%
  %% ICC profiles
  \tpDeclareGComp[suppl/cmyk.icc]{IccProfileFile}
  \tpDeclareGComp[4]{IccComponents}
  \tpDeclareGComp[Coated FOGRA39]{IccIdentifier}
}
\def\tp@set@ally@conf{%
  \addToConfig{intent}{profile=\tpUseComp{IccProfileFile};components=\tpUseComp{IccComponents};identifier=\tpUseComp{IccIdentifier}}%
}
\tpAddToHook[titlepage]{document-meta-hook}{\tp@set@ally@conf}
\directlua{ally = require('coco-accessibility')}
 % \setDocInfo{conformance}{pdfaid=2;level=A;pdfuaid=1}%
\def\tp@title@insert@xmp{%
  \edef\tp@xmp@file@name{\tpUseGComp{titlepage}{XmpFile}.xmp}%
  \IfFileExists{\tp@xmp@file@name}
    {\addToConfig{metadata}{xmpfile=\tp@xmp@file@name}%
     \directlua{ally.extract_meta()}}
    {\tpPackageError{A11y}{File}{\tp@xmp@file@name\space not found!}
      {Please make sure that the \tp@xmp@file@name\space exists.}}}
\protected\def\pdfglyphtounicode{\pdfextension glyphtounicode}
\input glyphtounicode
\edef\pdfgentounicode{\pdfvariable gentounicode}
\pdfgentounicode = 1
\newif\if@tp@use@default@icc\@tp@use@default@iccfalse
\IfFileExists{suppl/cmyk.icc}{\IfFileExists{suppl/srbg.icc}{\@tp@use@default@icctrue}{}}{}
\ifx\tp@icc@profile\@undefined
  \if@tp@use@default@icc
    \addToConfig{intent}{profile=suppl/\tp@color@enc.icc;components=4;identifier=PSO Uncoated ISO12647 (ECI)}
    \addToConfig{intent}{profile=suppl/srgb.icc;components=3;identifier=sRGB IEC61966-2.1}
  \fi
\fi
\AtBeginShipout{\directlua{ltpdfa.pageprocessor(tex.box["AtBeginShipoutBox"])}}%
\addRolemap{document}{Document}
\AtBeginDocument{\structStart{document}}
\AtEndDocument{\structEnd{document}}
\endinput
%%
%% End of file `coco-accessibility.sty'.
